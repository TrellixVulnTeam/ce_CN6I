
  var FacebookInvitePlugin = function() {
    this.provider = "facebook";
  }

  FacebookInvitePlugin.prototype.getOptions = function() {
    var options = {}
    options.provider = this.provider;
    options.isAvailableForDevice = this.isAvailableForDevice();

    return options;
  }

  FacebookInvitePlugin.prototype.inviteFriends = function(subject, text, referralDataUrl, image) {
 
    var scope = this;

    var showInviteFriendsDialog = function(subject, text, referralDataUrl, image) {
      facebookConnectPlugin.appInvite({
        url: referralDataUrl
      }, function(obj){
        console.log(obj);
        if(obj && obj.didComplete) {
          scope.completeCallback(null, null);
        } else {
          scope.cancelCallback();
        }
      }, function(err){
        onError(err)
        if(err.errorCode != null && err.errorCode == 4201) {
          scope.cancelCallback();
        } else {
          onError(err.errorMessage)
        }
      });
    }

    var onError = function(err) {
      console.log(JSON.stringify(err))
      scope.errorCallback(err);
    }

    if(cordova.platformId === "ios") {
      showInviteFriendsDialog(subject, text, referralDataUrl, image);
    } else {
      facebookConnectPlugin.getLoginStatus( function(userData) {
        if(userData.status !== "connected") {
          facebookConnectPlugin.login(["public_profile"],
             function() { showInviteFriendsDialog(subject, text, referralDataUrl, image) },
             onError
          );
        } else {
          showInviteFriendsDialog(subject, text, referralDataUrl, image);
        }
      }, onError);  
    }
    
  }



  FacebookInvitePlugin.prototype.__proto__ = GetSocial.InvitePlugin.prototype;

  window.GetSocialTestApp = {};
  window.GetSocialTestApp.FacebookInvitePlugin = FacebookInvitePlugin;

